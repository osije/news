 IIS PUT 6.0 漏洞扫描器

本工具用于扫描存在 **IIS 6.0 WebDAV PUT 漏洞** 的目标主机，并自动尝试上传测试文件及清理痕迹。支持并发扫描、结果输出到文件、目标批量导入等功能，适合在内网或渗透测试场景下快速发现潜在风险。

>  **免责声明**：本工具仅供授权测试与研究用途，禁止用于非法攻击行为！

---

## :pushpin: 功能特色

-  支持单目标或目标文件导入
-  可并发执行，加速扫描流程
-  自动识别 IIS/6.0 指纹
-  测试 `PUT` 漏洞是否存在
-  自动删除上传测试文件（清理痕迹）
-  可选输出结果到文件
-  伪造 User-Agent 隐匿行为

---

## :pushpin: 使用方法

###  构建

```bash
go build -o stealth_scanner main.go\
```
###  运行参数
```bash
./stealth_scanner -t 192.168.1.100
./stealth_scanner -f targets.txt -c 20 -o result.txt
```

### 参数说明
| 参数 | 说明|
| ---| ---|
| -t | 指定单个目标 IP 或域名|
| -f | 从文件中读取目标列表（每行一个）|
| -o | 将扫描结果输出到指定文件|
| -c | 设置并发数量（默认：10）|

###  示例输出

```text
[192.168.1.100] [VULNERABLE] | Server: Microsoft-IIS/6.0 | 上传成功, 已清理 (/abc123xyz.txt)
[192.168.1.101] [SAFE] | Server: Microsoft-IIS/8.5 | PUT 被拒绝 (403)
[192.168.1.102] [ERROR] 无法连接
```

##  漏洞原理说明

IIS 6.0 默认启用 WebDAV 功能，若未禁用 PUT 动作或未做权限限制，攻击者可上传任意文件至 Web 目录，形成远程代码执行等高危漏洞。

###  关键实现逻辑

指纹识别：通过 HEAD / 请求提取 Server 头信息，确认是否为 IIS 6.0

漏洞测试：尝试 PUT 上传随机文件（包含内容 VulnTest）

清理操作：上传成功后立即发送 DELETE 请求尝试删除测试文件

伪装行为：伪造 Firefox 浏览器 User-Agent 减少日志显著性

###  输入文件格式
targets.txt 示例（每行一个 IP 或域名）：

``` lua
192.168.1.100
web01.local
192.168.1.102
```

###  注意事项
工具使用 HTTP 协议（默认端口 80），如需支持 HTTPS 请自行扩展逻辑

若目标主机启用了认证或 IP 白名单，该方法可能失效

由于部分 WAF 会拦截 PUT 请求，可能导致误报或请求失败

###  法律声明
本工具仅供网络安全研究与合规测试用途。使用者需严格遵守当地法律法规，对因非法使用本工具造成的任何后果，开发者不承担任何责任。